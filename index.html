```html
<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>انیمیشن سه‌بعدی با اسکرول</title>
  <style>
    html,
    body {
      background: hsla(206, 14%, 34%, 1);
      color: #ddd;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      height: 100%;
      margin: 0;
      overflow-x: hidden;
      direction: rtl;
    }

    #app,
    canvas {
      display: block;
      height: 100vh;
      inset: 0;
      position: fixed;
      width: 100vw;
    }

    .scroller {
      height: 400vh;
      position: relative;
      pointer-events: none;
    }

    .label {
      bottom: 16px;
      font-size: 14px;
      right: 16px;
      opacity: 0.7;
      pointer-events: none;
      position: fixed;
      user-select: none;
    }

    .loading {
      background: rgba(10, 16, 20, 0.9);
      color: #e7eef4;
      display: grid;
      inset: 0;
      place-items: center;
      position: fixed;
      transition: opacity 0.4s ease, visibility 0.4s ease;
      z-index: 10;
    }

    .loading.hidden {
      opacity: 0;
      visibility: hidden;
    }

    .loading__card {
      width: min(420px, 80vw);
      padding: 20px 22px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.06);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.35), inset 0 1px 0 rgba(255, 255, 255, 0.06);
      backdrop-filter: blur(6px);
    }

    .loading__title {
      font: 600 16px/1.2 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      margin-bottom: 12px;
      text-align: center;
    }

    .loading__progress-wrap {
      width: 100%;
      height: 10px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 999px;
      overflow: hidden;
    }

    .loading__progress {
      width: 0%;
      height: 100%;
      background: linear-gradient(90deg, #7cc3ff, #84ffcc);
      transition: width 0.1s linear;
    }

    .loading__progress-text {
      margin-top: 8px;
      font-size: 12px;
      opacity: 0.8;
      text-align: left;
    }
  </style>
</head>
<body>
  <div id="app"></div>
  <div class="loading" id="loading">
    <div class="loading__card">
      <div class="loading__title">در حال بارگذاری...</div>
      <div class="loading__progress-wrap">
        <div class="loading__progress" id="progress"></div>
      </div>
      <div class="loading__progress-text" id="progressText">۰٪</div>
    </div>
  </div>
  <div class="scroller"></div>
  <div class="label">برای حرکت دوربین اسکرول کنید <code>lookAt</code> هدف</div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
  <script>
    // Register GSAP ScrollTrigger
    gsap.registerPlugin(ScrollTrigger);

    // DOM Elements
    const app = document.getElementById("app");
    const loadingEl = document.getElementById("loading");
    const progressEl = document.getElementById("progress");
    const progressTextEl = document.getElementById("progressText");

    // Three.js Scene Setup
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x708697);

    // Camera
    const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.01, 1000);
    camera.position.set(0, 3, 4);

    // Renderer
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.toneMapping = THREE.ACESFilmicToneMapping;
    renderer.toneMappingExposure = 1.4;
    renderer.physicallyCorrectLights = true;
    app.appendChild(renderer.domElement);

    // Lights
    scene.add(new THREE.AmbientLight(0xffffff, 0.8));
    const hemiLight = new THREE.HemisphereLight(0xffffff, 0x404040, 0.3);
    hemiLight.position.set(0, 300, 0);
    scene.add(hemiLight);
    const dirLight = new THREE.DirectionalLight(0xffffff, 4);
    dirLight.position.set(5, 10, 5);
    dirLight.castShadow = false;
    scene.add(dirLight);

    // Look Target
    const lookTarget = new THREE.Object3D();
    scene.add(lookTarget);

    // Waypoints
    const waypoints = [
      {
        label: "صفحه‌کلید",
        targetName: "keyboard",
        fallback: { x: 0, y: 0.3, z: 0.3 },
        theta: Math.PI * 0.15,
        phi: Math.PI * 0.35,
        radius: 4.0,
        fov: 20,
        duration: 1,
        hold: 1
      },
      {
        label: "سمت چپ",
        targetName: "leftside",
        fallback: { x: -0.3, y: 0.5, z: -0.2 },
        theta: Math.PI * 0.3,
        phi: Math.PI * 0.4,
        radius: 3.2,
        fov: 40,
        duration: 1,
        hold: 1
      },
      {
        label: "جلو",
        targetName: "front",
        fallback: { x: 0.085, y: 0.6, z: 0 },
        theta: Math.PI * 0,
        phi: Math.PI * 0.5,
        radius: 2.6,
        fov: 45,
        duration: 1,
        hold: 1
      },
      {
        label: "بالا",
        targetName: "top",
        fallback: { x: 0.085, y: 0.6, z: 0 },
        theta: Math.PI * 0,
        phi: Math.PI / 2 - 0.92,
        radius: 2.6,
        fov: 50,
        duration: 1,
        hold: 1
      },
      {
        label: "سمت راست",
        targetName: "rightside",
        fallback: { x: 0.1, y: 0.6, z: 0.2 },
        theta: Math.PI * 1.7,
        phi: Math.PI * 0.4,
        radius: 2.8,
        fov: 42,
        duration: 1,
        hold: 1
      }
    ];

    // Load GLB Model
    const loader = new THREE.GLTFLoader();
    const MODEL_URL = "https://assets.codepen.io/204808/computer_terminal.glb";

    loader.load(
      MODEL_URL,
      (gltf) => {
        const model = gltf.scene;
        model.visible = false;
        scene.add(model);

        model.traverse((child) => {
          if (child.isMesh && child.material && child.material.isMeshStandardMaterial) {
            const m = child.material;
            m.transparent = true;
            m.depthWrite = false;
            m.needsUpdate = true;
          }
        });

        const bbox = new THREE.Box3().setFromObject(model);
        const center = bbox.getCenter(new THREE.Vector3());
        const originalFocus = center.clone();
        const originalPos = camera.position.clone();
        const originalFov = camera.fov;

        camera.lookAt(originalFocus);

        setupScrollCamera(model, waypoints, { originalPos, originalFocus, originalFov });

        // Update progress UI
        progressEl.style.width = "100%";
        progressTextEl.textContent = "۱۰۰٪";

        // Reveal model
        requestAnimationFrame(() => {
          model.visible = true;
          loadingEl.classList.add("hidden");
        });
      },
      (xhr) => {
        if (xhr.lengthComputable) {
          const pct = Math.max(0, Math.min(100, (xhr.loaded / xhr.total) * 100));
          progressEl.style.width = `${pct.toFixed(0)}%`;
          progressTextEl.textContent = `${pct.toFixed(0)}٪`;
        } else {
          const current = parseFloat(progressEl.style.width) || 0;
          const next = Math.min(90, current + 1);
          progressEl.style.width = `${next}%`;
          progressTextEl.textContent = `${next}٪`;
        }
      },
      (err) => {
        console.error("خطا در بارگذاری مدل GLB:", err?.message || err);
        progressTextEl.textContent = "خطا";
      }
    );

    // Render Loop
    function render() {
      renderer.render(scene, camera);
    }
    renderer.setAnimationLoop(render);

    // Resize Handling
    window.addEventListener("resize", () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });

    // Scroll Camera Animation
    function setupScrollCamera(model, waypoints, originals = {}) {
      const clamp = (v, min, max) => Math.min(Math.max(v, min), max);
      const getWorldPosByName = (root, substr) => {
        const needle = (substr || "").toLowerCase();
        let out = null;
        root.traverse((ch) => {
          if (out || !ch.isMesh) return;
          const n = (ch.name || "").toLowerCase();
          if (n.includes(needle)) {
            out = new THREE.Vector3();
            ch.getWorldPosition(out);
          }
        });
        return out;
      };
      const normalizeAngle = (a) => {
        const TWO_PI = Math.PI * 2;
        a = a % TWO_PI;
        return a < -Math.PI ? a + TWO_PI : a > Math.PI ? a - TWO_PI : a;
      };

      const originalPos = originals.originalPos ? originals.originalPos.clone() : camera.position.clone();
      const originalFocus = originals.originalFocus ? originals.originalFocus.clone() : lookTarget?.position?.clone?.() ?? center.clone();
      const originalFov = originals.originalFov ?? camera.fov;

      const resolved = waypoints.map((w) => {
        let target = w.targetName ? getWorldPosByName(model, w.targetName) : null;
        if (!target && w.fallback) target = new THREE.Vector3(w.fallback.x, w.fallback.y, w.fallback.z);
        if (!target) target = center.clone();
        return {
          label: w.label || "",
          focus: target,
          theta: w.theta,
          phi: clamp(w.phi, 0.05, Math.PI - 0.05),
          radius: Math.max(0.1, w.radius),
          fov: w.fov ?? camera.fov,
          duration: w.duration ?? 1
        };
      });

      const startFocus = originalFocus.clone();
      const startOffset = new THREE.Vector3().subVectors(originalPos, startFocus);
      const startSph = new THREE.Spherical().setFromVector3(startOffset);
      const startState = {
        theta: normalizeAngle(startSph.theta),
        phi: clamp(startSph.phi, 0.1, Math.PI - 0.1),
        radius: Math.max(0.1, startSph.radius),
        fov: originalFov
      };

      const camState = { ...startState };
      const focusState = { x: startFocus.x, y: startFocus.y, z: startFocus.z };

      const tl = gsap.timeline({
        scrollTrigger: {
          trigger: document.body,
          start: "top top",
          end: "+=30000",
          scrub: 1,
          markers: true
        },
        onUpdate: () => {
          const focusV3 = new THREE.Vector3(focusState.x, focusState.y, focusState.z);
          const pos = new THREE.Vector3().setFromSpherical(new THREE.Spherical(camState.radius, camState.phi, camState.theta));
          camera.position.copy(focusV3).add(pos);
          camera.fov = camState.fov;
          camera.updateProjectionMatrix();
          camera.lookAt(focusV3);
          if (lookTarget) lookTarget.position.copy(focusV3);
        }
      });

      resolved.forEach((p) => {
        tl.to(camState, {
          theta: normalizeAngle(p.theta),
          phi: p.phi,
          radius: p.radius,
          fov: p.fov,
          duration: p.duration,
          ease: "none"
        }).to(
          focusState,
          {
            x: p.focus.x,
            y: p.focus.y,
            z: p.focus.z,
            duration: p.duration,
            ease: "none"
          },
          "<"
        );

        const holdDur = p.hold ?? 0.3;
        if (holdDur > 0) {
          tl.to(camState, {
            theta: "+=0",
            phi: "+=0",
            radius: "+=0",
            fov: "+=0",
            duration: holdDur,
            ease: "none"
          }).to(
            focusState,
            {
              x: "+=0",
              y: "+=0",
              z: "+=0",
              duration: holdDur,
              ease: "none"
            },
            "<"
          );
        }
      });

      tl.to(camState, {
        theta: 0.35,
        phi: 1.04,
        radius: 7,
        fov: 60,
        duration: 1.0,
        ease: "none"
      }).to(
        focusState,
        {
          x: originalFocus.x,
          y: originalFocus.y,
          z: originalFocus.z,
          duration: 1.0,
          ease: "none"
        },
        "<"
      );
    }

    // Credit
    console.log("منبع: https://sketchfab.com/3d-models/van-gogh-bedroom-in-arles-night-7c28126099404406bd0f5c150d809394");
  </script>
</body>
</html>
```
